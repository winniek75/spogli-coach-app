# 協力学習システム（Collaborative Learning System）

MovWISEの協力学習システムは、講師と生徒がリアルタイムで画面を共有し、協力して学習を進めることができる機能です。

## 🚀 機能概要

### 講師側の機能
- **リアルタイム画面共有**: 生徒の画面をリアルタイムで確認
- **指導ツール**: ヒント、励まし、修正指示などを瞬時に送信
- **セッション管理**: 複数の生徒との同時セッション管理
- **進捗モニタリング**: 生徒の学習状況をリアルタイムで把握

### 生徒側の機能
- **画面共有**: 自分の学習画面を講師と共有
- **リアルタイム指導受信**: 講師からのアドバイスを即座に受信
- **注釈表示**: 画面上に講師からの指示を視覚的に表示
- **簡単接続**: 招待コードで簡単にセッションに参加

## 🛠️ システム構成

### フロントエンド
- **講師ダッシュボード**: `/src/views/teacher/TeacherDashboard.vue`
- **生徒セッション**: `/src/views/student/StudentSession.vue`
- **協力セッションサービス**: `/src/services/collaborativeSession.js`

### バックエンド
- **WebSocketサーバー**: `/server.js`
- **Socket.IOベース**: リアルタイム通信
- **WebRTCシグナリング**: 画面共有

## 📋 セットアップ手順

### 1. サーバー依存関係のインストール

```bash
# サーバー用の依存関係をインストール
cp package-server.json package.json
npm install
```

### 2. WebSocketサーバーの起動

```bash
# 開発モード（自動リロード）
npm run dev

# または本番モード
npm start
```

サーバーは http://localhost:3001 で起動します。

### 3. フロントエンドの起動

```bash
# 別のターミナルでフロントエンドを起動
npm run dev  # または yarn dev
```

## 🎯 使用方法

### 講師側の操作

1. **講師ダッシュボードにアクセス**
   - ブラウザで `http://localhost:3000/teacher-dashboard` を開く

2. **協力学習セッションの開始**
   - 「協力学習セッション開始」ボタンをクリック
   - 講師名と学習内容を入力
   - 生成された招待コードをメモ

3. **生徒の招待**
   - 招待コードを生徒に伝える
   - 生徒の接続を待つ

4. **指導の実施**
   - 生徒の画面をリアルタイムで確認
   - 指導ツールを使ってアドバイスを送信
   - 進捗をモニタリング

### 生徒側の操作

1. **セッションへの参加**
   - ブラウザで学習アプリにアクセス
   - 講師から受け取った招待コードを入力
   - 名前を入力して参加

2. **画面共有の開始**
   - 「画面を共有」ボタンをクリック
   - ブラウザの画面共有許可を与える

3. **学習の開始**
   - 通常通り学習ゲームをプレイ
   - 講師からの指導を画面上で確認

## 🔧 技術仕様

### WebRTC画面共有
```javascript
// 画面共有の開始
const stream = await navigator.mediaDevices.getDisplayMedia({
  video: { mediaSource: 'screen', width: { ideal: 1920 }, height: { ideal: 1080 } },
  audio: true
})
```

### Socket.IOイベント
- `create-session`: セッション作成
- `join-session`: セッション参加
- `webrtc-offer`: WebRTCオファー
- `webrtc-answer`: WebRTCアンサー
- `webrtc-ice-candidate`: ICE候補交換
- `teacher-guidance`: 講師からの指導
- `game-state-sync`: ゲーム状態同期

### リアルタイム指導メッセージ
```javascript
// 講師から生徒へのメッセージ送信
collaborativeSession.sendTeacherGuidance('hint', {
  message: 'ヒント: 問題をよく読んで、キーワードを探してみましょう。',
  timestamp: Date.now()
})
```

## 🎮 対応ゲーム

現在、以下のゲームで協力学習が利用可能です：

### 文法銀河（Grammar Galaxy）
- Be動詞ゲーム
- 一般動詞ゲーム
- 語順ゲーム

### サウンド星雲（Sound Adventure）
- フォニックス学習
- 発音練習

## 📊 セッション統計

システムは以下の統計情報を提供します：

- **セッション時間**: 各セッションの継続時間
- **参加者数**: 同時接続している生徒数
- **指導回数**: 講師が送信した指導メッセージ数
- **学習効果**: 協力学習による成績向上データ

## 🔒 セキュリティ

### 接続セキュリティ
- セッションごとのユニークな招待コード
- 24時間後の自動セッション削除
- 講師による生徒の接続管理

### プライバシー保護
- 画面共有は学習アプリ内のみ
- セッション終了時の完全データ削除
- ローカルネットワーク内での通信

## 🐛 トラブルシューティング

### よくある問題

**Q: 画面共有ができない**
A: ブラウザで画面共有の許可が必要です。ブラウザの設定を確認してください。

**Q: 接続できない**
A: WebSocketサーバー（port 3001）が起動していることを確認してください。

**Q: 音声が聞こえない**
A: ブラウザのマイク・音声許可を確認してください。

### ログの確認
```bash
# サーバーログを確認
npm start

# ブラウザのコンソールでクライアントログを確認
// 開発者ツール > Console
```

## 🚀 今後の機能拡張

### 計画中の機能
- **音声チャット**: リアルタイム音声通話
- **セッション録画**: 学習セッションの録画・再生
- **マルチ講師**: 複数の講師による協力指導
- **AIアシスタント**: AI による自動指導補助

### 技術的改善
- **スケーラビリティ**: より多くの同時接続への対応
- **低遅延化**: 通信遅延の最小化
- **モバイル対応**: スマートフォン・タブレット最適化

## 📞 サポート

技術的な問題や質問がある場合は、開発チームまでお問い合わせください。

---

**MovWISE 協力学習システム v1.0.0**  
*リアルタイム教育で、学習の未来を創造する*